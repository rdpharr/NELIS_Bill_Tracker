<div class='row'>
    <div class="card border-dark col-md-8">
        <div class="card-block">
            <div class="card-header">
                <h4>{{title}}</h4>
            </div>
            <div class="card-body text-dark">
                <p class="lead card-text">Welcome to the Mass Liberation Project's Nevada Bill Tracker. Track the bills you care about about here.</p>
                <hr>
                <form method="post" class="form-inline mt-4 mt-md-0" action="/search">
                    <div class="row">
                        <div class="col-md-8">
                            <p>Search for bills that you might want to track. Use the search box in the upper right corner. Try searching for <b>"criminal"</b>, <b>"juvenile"</b>, <b>"penalty"</b> or <b>"firearm"</b>. You can also search by BDR number. </p>
                        </div>
                        <div class="col-md-3">
                            <input class="form-control mr-md-4" type="text" name="SearchValue"
                                   placeholder="Search for Bill"
                                   aria-label="Search">
                        </div>
                            <div class="col-md-1">
                            <button class="btn btn-primary my-2 my-sm-0" type="submit">Search</button>
                        </div>
                    </div>
                </form>
                <hr>
                <div class="row">
                    <div class="col-md-8">
                        <p>See the bills you track on the home page, with data about their next hearing date. Go to <a href="bills">all bills</a> to start tracking some bills. They will show up in the table below.</p>
                    </div>
                    <div class="col-md-4">
                        <a href="/bills" class="btn btn-primary">View All Bills</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card-block">
            <div class="card-header">
                <h4>Links</h4>
            </div>
            <div class="card-body text-dark">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item"><a href="https://www.facebook.com/massliberationprojectnv/">Mass Liberation of NV</a></li>
                    <li class="list-group-item"><a href="https://www.leg.state.nv.us/App/NELIS/REL/81st2021">NELIS</a></li>
                    <li class="list-group-item"><a href="https://www.leg.state.nv.us/App/Opinions/81st2021/">Comment on a Bill</a></li>
                </ul>

            </div>
        </div>
    </div>
</div>
<br/>
<div class="row">
    <div class="card border-danger col-md-6">
        <div class="card-block">
            <div class="card-header bg-danger text-white"><h4>Bills We Oppose</h4></div>
            <div class="card-body text-dark">
                <table id="opposeTable" class="table table-striped table-bordered display responsive" style="width:100%">
                    <thead>
                    <tr><th>Bill</th><th>Summary</th><th>Impact</th><th>Comment</th></tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><a href="https://www.leg.state.nv.us/App/NELIS/REL/81st2021/Bill/7250/Overview">AB10</a></td>
                        <td>Revises provisions relating to vehicular manslaughter. (BDR 43-367)</td>
                        <td>Adds more people to jails and prisons by increasing penalties for vehicular manslaughter.</td>
                        <td><a href="https://www.leg.state.nv.us/App/Opinions/81st2021/">Send a Comment to Legislators</a></td>
                    </tr>
                    <tr>
                        <td><a href="https://www.leg.state.nv.us/App/NELIS/REL/81st2021/Bill/7317/Overview">AB64</a></td>
                        <td>Revises provisions relating to certain crimes. (BDR 15-407)</td>
                        <td>Adds more people to jails and prisons by increasing penalties for sex work. We know also these crimes are enforced along racial and gender lines, targeting Black women.</td>
                        <td><a href="https://www.leg.state.nv.us/App/Opinions/81st2021/">Send a Comment to Legislators</a></td>
                    </tr>
                    <tr>
                        <td><a href="https://www.leg.state.nv.us/App/NELIS/REL/81st2021/Bill/7205/Overview">SB30</a></td>
                        <td>Revises the penalties for certain unlawful acts committed by prisoners relating to human excrement or bodily fluid. (BDR 16-351)</td>
                        <td>Keeps people in jails or prisons by increasing penalties. The title of the bill sounds terrible, but often the crime is spitting on an officer, and can even be applied for bleeding on an officer while being beaten.</td>
                        <td><a href="https://www.leg.state.nv.us/App/Opinions/81st2021/">Send a Comment to Legislators</a></td>
                    </tr>
                    <tr>
                        <td><a href="https://www.leg.state.nv.us/App/NELIS/REL/81st2021/Bill/7222/Overview">SB45</a></td>
                        <td>Revises provisions relating to crimes. (BDR 18-421)</td>
                        <td>Adds more people to jails and prisons by increasing penalties for domestic violence against a pregnant person. There is no evidence that the existing penalties are insufficient.</td>
                        <td><a href="https://www.leg.state.nv.us/App/Opinions/81st2021/">Send a Comment to Legislators</a></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="card border-success col-md-6">
        <div class="card-block">
            <div class="card-header bg-primary text-white"><h4>Bills We Support</h4></div>
            <div class="card-body text-dark">
                <table id="supportTable" class="table table-striped table-bordered display responsive" style="width:100%">
                    <thead>
                    <tr><th>Bill</th><th>Summary</th><th>Impact</th><th>Comment</th></tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><a href="https://www.leg.state.nv.us/App/NELIS/REL/81st2021/Bill/7259/Overview">AB17</a></td>
                        <td>Revises provisions relating to the discharge of certain persons from probation or parole. (BDR 14-334)</td>
                        <td>Dishonorable discharge from parole or probation is one of the ways we "forever punish" people in the system. This removes the distinction between honorable and dishonorable.</td>
                        <td><a href="https://www.leg.state.nv.us/App/Opinions/81st2021/">Send a Comment to Legislators</a></td>
                    </tr>
                    <tr>
                        <td><a href="https://www.leg.state.nv.us/App/NELIS/REL/81st2021/Bill/7228/Overview">SB50</a></td>
                        <td>Revises provisions relating to warrants. (BDR 14-405)</td>
                        <td>This could result in fewer no knock warrants - the kind used in Breonna Taylor's murder - by adding more hoops for enforcement to jump through before getting one.</td>
                        <td><a href="https://www.leg.state.nv.us/App/Opinions/81st2021/">Send a Comment to Legislators</a></td>
                    </tr>
                    </tbody>
                </table>

            </div>
        </div>
    </div>
</div>
<br>
<div class='row'>
    <div class="card border-dark col-md-12">
        <div class="card-block">
            <div class="card-header">
                <h4>My Bills</h4>
            </div>
            <div class="card-body text-dark">
                <table id="myBillsTable" class="table table-striped table-bordered display responsive" style="width:100%">
                    <thead>
                    <tr>
                        <th>Bill</th>
                        <th>Summary</th>
                        <th>Introduced</th>
                        <th>Sponsor</th>
                        <th>Hearings</th>
                        <th>Bill Tracking</th>
                    </tr>
                    </thead>
                    <tbody>
                    {{#each my_bills}}
                        <tr>
                            <td><a href="https://www.leg.state.nv.us{{this.url}}">{{this.bill}}</a></td>
                            <td>{{this.summary}}</td>
                            <td>{{dateFormat this.introduced "YYYY-MM-DD"}}</td>
                            <td>{{this.primary_sponsor}}</td>
                            <td>{{this.upcoming_hearings}}</td>
                            {{#if this.tracked}}
                                <td><input type="button" id="btn_{{this.bill}}" class="btn btn-outline-danger btn-sm" type="button" onclick="toggle_tracking('{{this.bill}}')" value="Untrack"></td>
                            {{else}}
                                <td><input type="button" id="btn_{{this.bill}}" class="btn btn-outline-primary btn-sm" type="button" onclick="toggle_tracking('{{this.bill}}')" value="Track"></td>
                            {{/if}}
                        </tr>
                    {{/each}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<br/>
<div class='row'>
    <div class="card border-dark col-md-12">
        <div class="card-block">
            <div class="card-header">
                <h4>New Bills (Last 2 days)</h4>
            </div>
            <div class="card-body text-dark">
                <table id="newBillsTable" class="table table-striped table-bordered display responsive" style="width:100%">
                    <thead>
                    <tr>
                        <th>Bill</th>
                        <th>Summary</th>
                        <th>Introduced</th>
                        <th>Sponsor</th>
                        <th>Hearings</th>
                        <th>Bill Tracking</th>
                    </tr>
                    </thead>
                    <tbody>
                    {{#each new_bills}}
                        <tr>
                            <td><a href="https://www.leg.state.nv.us{{this.url}}">{{this.bill}}</a></td>
                            <td>{{this.summary}}</td>
                            <td>{{dateFormat this.introduced "YYYY-MM-DD"}}</td>
                            <td>{{this.primary_sponsor}}</td>
                            <td>{{this.upcoming_hearings}}</td>
                            {{#if this.tracked}}
                                <td><input type="button" id="btn_{{this.bill}}" class="btn btn-outline-danger btn-sm" type="button" onclick="toggle_tracking('{{this.bill}}')" value="Untrack"></td>
                            {{else}}
                                <td><input type="button" id="btn_{{this.bill}}" class="btn btn-outline-primary btn-sm" type="button" onclick="toggle_tracking('{{this.bill}}')" value="Track"></td>
                            {{/if}}
                        </tr>
                    {{/each}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>


<script>
    $(document).ready(function () {
        ready_table('#myBillsTable');
        ready_table('#newBillsTable');
    });
    function ready_table(table_name){
        $.fn.dataTable.ext.errMode = 'none';
        let table = $(table_name).DataTable({
            fixedHeader: true,
            autoWidth: true,
            dom: 'Bltip',
            buttons: [
                'csvHtml5',
                'excelHtml5',
                'pdfHtml5'
            ],
        });
        $(table_name +' thead tr').clone(true).appendTo(table_name +' thead');
        $(table_name +' thead tr:eq(1) th').each(function (i) {
            var title = $(this).text();
            $(this).html('<input type="text" placeholder="Search ' + title + '" style="width:90%" />');
            $('input', this).on('keyup change', function () {
                if (table.column(i).search() !== this.value) {
                    table
                            .column(i)
                            .search(this.value)
                            .draw();
                }
            });
        });
    }
    function toggle_tracking(bill){
        let btn = $('#btn_' + bill);
        console.log(btn.val());
        if (btn.val()==='Track'){
            document.cookie=bill+"=true;expires=1 Jul 2021 12:00:00 GMT;";
            btn.val("Untrack");
            btn.removeClass("btn-outline-primary");
            btn.addClass("btn-outline-danger");
        } else {
            document.cookie=bill+"=true;Max-Age=-99999999;";
            btn.val("Track");
            btn.removeClass("btn-outline-danger");
            btn.addClass("btn-outline-primary");
        }
    }
</script>
